<div class="container">
  <form class="signup" (ngSubmit)="signup()" [formGroup]="signupForm">
    <h2>Signup</h2>

    <div class="form-group">
      <input type="text" formControlName="fullName" placeholder="Full Name" required>
      <div class="error-message" *ngIf="signupForm.get('fullName')?.invalid && signupForm.get('fullName')?.touched">
        Full name is required
      </div>
    </div>

    <div class="form-group">
      <input type="text" formControlName="username" placeholder="Username" required>
      <div class="error-message" *ngIf="signupForm.get('username')?.invalid && signupForm.get('username')?.touched">
        <span *ngIf="signupForm.get('username')?.errors?.['required']">Username is required</span>
        <span *ngIf="signupForm.get('username')?.errors?.['minlength']">Username must be at least 4 characters</span>
        <span *ngIf="signupForm.get('username')?.errors?.['pattern']">Username can only contain letters, numbers, and underscores</span>
      </div>
    </div>

    <div class="form-group">
      <input type="number" formControlName="phoneNumber" placeholder="Phone Number" required>
      <div class="error-message" *ngIf="signupForm.get('phoneNumber')?.invalid && signupForm.get('phoneNumber')?.touched">
        Valid phone number is required
      </div>
    </div>

    <div class="form-group userType-wrapper">
      <label class="userType-label">User Type:</label>
      <select formControlName="userType" class="userType-select" required>
        <option value="" disabled selected>Select User Type</option>
        <option value="doctor">Doctor</option>
        <option value="patient">Patient</option>
      </select>
      <div class="error-message" *ngIf="signupForm.get('userType')?.invalid && signupForm.get('userType')?.touched">
        Please select a user type
      </div>
    </div>

    <div class="form-group password-field">
      <input type="password" formControlName="password" id="password" placeholder="Password" required>
      <span class="toggle-password" (click)="togglePasswordVisibility('password')">
        <i [class]="passwordVisible ? 'fas fa-eye-slash' : 'fas fa-eye'"></i>
      </span>
      <div class="error-message" *ngIf="signupForm.get('password')?.invalid && signupForm.get('password')?.touched">
        Password must be at least 8 characters
      </div>
    </div>

    <div class="form-group password-field">
      <input type="password" formControlName="confirmPassword" id="confirm-password" placeholder="Confirm Password" required>
      <span class="toggle-password" (click)="togglePasswordVisibility('confirmPassword')">
        <i [class]="confirmPasswordVisible ? 'fas fa-eye-slash' : 'fas fa-eye'"></i>
      </span>
      <div class="error-message" *ngIf="signupForm.get('confirmPassword')?.invalid && signupForm.get('confirmPassword')?.touched">
        Please confirm your password
      </div>
      <div class="error-message" *ngIf="signupForm.errors?.['passwordMismatch'] && signupForm.get('confirmPassword')?.touched">
        Passwords do not match
      </div>
    </div>
      
    <div class="form-group image-upload">
      <label for="image">Upload Profile Image:</label>
      <input type="file" id="image" formControlName="image" (change)="onImageUpload($event)" accept="image/*">
      <div class="error-message" *ngIf="signupForm.get('image')?.invalid && signupForm.get('image')?.touched">
        Please upload a profile image
      </div>
    </div>

    <button type="submit" class="submit-btn" [disabled]="signupForm.invalid">Register</button>
  </form>
</div>